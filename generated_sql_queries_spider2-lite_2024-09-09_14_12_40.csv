db_id|question|generated_sql_query|gold_sql_query|result
bigquery-public-data.ga4_obfuscated_sample_ecommerce|How many pseudo users were active in the last 7 days but inactive in the last 2 days as of January 7, 2021?|with activeusers as ( select user_pseudo_id from `bigquery-public-data`.ga4_obfuscated_sample_ecommerce.events_20210101 union all select user_pseudo_id from `bigquery-public-data`.ga4_obfuscated_sample_ecommerce.events_20210102 union all select user_pseudo_id from `bigquery-public-data`.ga4_obfuscated_sample_ecommerce.events_20210103 union all select user_pseudo_id from `bigquery-public-data`.ga4_obfuscated_sample_ecommerce.events_20210104 union all select user_pseudo_id from `bigquery-public-data`.ga4_obfuscated_sample_ecommerce.events_20210105 union all select user_pseudo_id from `bigquery-public-data`.ga4_obfuscated_sample_ecommerce.events_20210106 union all select user_pseudo_id from `bigquery-public-data`.ga4_obfuscated_sample_ecommerce.events_20210107 ), inactiveusers as ( select user_pseudo_id from `bigquery-public-data`.ga4_obfuscated_sample_ecommerce.events_20210105 union all select user_pseudo_id from `bigquery-public-data`.ga4_obfuscated_sample_ecommerce.events_20210106 ) select count(distinct activeusers.user_pseudo_id) from activeusers left join inactiveusers on activeusers.user_pseudo_id = inactiveusers.user_pseudo_id where inactiveusers.user_pseudo_id is null;|select count(distinct mdaysusers.user_pseudo_id) as n_day_inactive_users_count from ( select user_pseudo_id from `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_*` as t cross join unnest(t.event_params) as event_params where event_params.key = 'engagement_time_msec' and event_params.value.int_value > 0 /* has engaged in last m = 7 days */ and event_timestamp > unix_micros(timestamp_sub(timestamp('2021-01-07 23:59:59'), interval 7 day)) /* include only relevant tables based on the fixed timestamp */ and _table_suffix between '20210101' and '20210107' ) as mdaysusers left join ( select user_pseudo_id from `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_*` as t cross join unnest(t.event_params) as event_params where event_params.key = 'engagement_time_msec' and event_params.value.int_value > 0 /* has engaged in last n = 2 days */ and event_timestamp > unix_micros(timestamp_sub(timestamp('2021-01-07 23:59:59'), interval 2 day)) /* include only relevant tables based on the fixed timestamp */ and _table_suffix between '20210105' and '20210107' ) as ndaysusers on mdaysusers.user_pseudo_id = ndaysusers.user_pseudo_id where ndaysusers.user_pseudo_id is null;|
bigquery-public-data.google_analytics_sample|Find the top-selling product among customers who bought 'Youtube Men’s Vintage Henley' in July 2017, excluding itself.|with july2017sessions as ( select fullvisitorid from `bigquery-public-data`.google_analytics_sample.ga_sessions_20170710 union all select fullvisitorid from `bigquery-public-data`.google_analytics_sample.ga_sessions_20170713 union all select fullvisitorid from `bigquery-public-data`.google_analytics_sample.ga_sessions_20170716 union all select fullvisitorid from `bigquery-public-data`.google_analytics_sample.ga_sessions_20170719 union all select fullvisitorid from `bigquery-public-data`.google_analytics_sample.ga_sessions_20170721 union all select fullvisitorid from `bigquery-public-data`.google_analytics_sample.ga_sessions_20170722 union all select fullvisitorid from `bigquery-public-data`.google_analytics_sample.ga_sessions_20170724 union all select fullvisitorid from `bigquery-public-data`.google_analytics_sample.ga_sessions_20170725 union all select fullvisitorid from `bigquery-public-data`.google_analytics_sample.ga_sessions_20170727 union all select fullvisitorid from `bigquery-public-data`.google_analytics_sample.ga_sessions_20170729 union all select fullvisitorid from `bigquery-public-data`.google_analytics_sample.ga_sessions_20170731 union all select fullvisitorid from `bigquery-public-data`.google_analytics_sample.ga_sessions_20170801 ), july2017henleybuyers as ( select distinct fullvisitorid from `bigquery-public-data`.google_analytics_sample.ga_sessions_20170710, unnest(hits) as hit where hit.item.productname = 'youtube men’s vintage henley' union all select distinct fullvisitorid from `bigquery-public-data`.google_analytics_sample.ga_sessions_20170713, unnest(hits) as hit where hit.item.productname = 'youtube men’s vintage henley' union all select distinct fullvisitorid from `bigquery-public-data`.google_analytics_sample.ga_sessions_20170716, unnest(hits) as hit where hit.item.productname = 'youtube men’s vintage henley' union all select distinct fullvisitorid from `bigquery-public-data`.google_analytics_sample.ga_sessions_20170719, unnest(hits) as hit where hit.item.productname = 'youtube men’s vintage henley' union all select distinct fullvisitorid from `bigquery-public-data`.google_analytics_sample.ga_sessions_20170721, unnest(hits) as hit where hit.item.productname = 'youtube men’s vintage henley' union all select distinct fullvisitorid from `bigquery-public-data`.google_analytics_sample.ga_sessions_20170722, unnest(hits) as hit where hit.item.productname = 'youtube men’s vintage henley' union all select distinct fullvisitorid from `bigquery-public-data`.google_analytics_sample.ga_sessions_20170724, unnest(hits) as hit where hit.item.productname = 'youtube men’s vintage henley' union all select distinct fullvisitorid from `bigquery-public-data`.google_analytics_sample.ga_sessions_20170725, unnest(hits) as hit where hit.item.productname = 'youtube men’s vintage henley' union all select distinct fullvisitorid from `bigquery-public-data`.google_analytics_sample.ga_sessions_20170727, unnest(hits) as hit where hit.item.productname = 'youtube men’s vintage henley' union all select distinct fullvisitorid from `bigquery-public-data`.google_analytics_sample.ga_sessions_20170729, unnest(hits) as hit where hit.item.productname = 'youtube men’s vintage henley' union all select distinct fullvisitorid from `bigquery-public-data`.google_analytics_sample.ga_sessions_20170731, unnest(hits) as hit where hit.item.productname = 'youtube men’s vintage henley' union all select distinct fullvisitorid from `bigquery-public-data`.google_analytics_sample.ga_sessions_20170801, unnest(hits) as hit where hit.item.productname = 'youtube men’s vintage henley' ) select item.productname, sum(item.itemrevenue) as totalrevenue from july2017sessions, july2017henleybuyers, `bigquery-public-data`.google_analytics_sample.ga_sessions_20170710, unnest(hits) as hit where july2017sessions.fullvisitorid = july2017henleybuyers.fullvisitorid and july2017henleybuyers.fullvisitorid = ga_sessions_20170710.fullvisitorid and hit.item.productname != 'youtube men’s vintage henley' group by 1 order by totalrevenue desc limit 1;|"with get_cus_id as ( select distinct fullvisitorid as henley_customer_id from `bigquery-public-data.google_analytics_sample.ga_sessions_201707*`, unnest(hits) as hits, unnest(hits.product) as product where product.v2productname = ""youtube men's vintage henley"" and product.productrevenue is not null ) select product.v2productname as other_purchased_products from `bigquery-public-data.google_analytics_sample.ga_sessions_201707*` tab_a right join get_cus_id on get_cus_id.henley_customer_id=tab_a.fullvisitorid, unnest(hits) as hits, unnest(hits.product) as product where tab_a.fullvisitorid in ( select * from get_cus_id ) and product.v2productname <> ""youtube men's vintage henley"" and product.productrevenue is not null group by product.v2productname order by sum(product.productquantity) desc limit 1;"|
